2025-10-28 10:26:04 | scripts.LLMquery.api_server | INFO | üß© Logger initialized for LLM ‚Üí /Users/kousiknandury/PycharmProjects/DL_project/logs/llm_logs/llm_20251028_102604.log
2025-10-28 10:26:04 | scripts.LLMquery.api_server | INFO | üöÄ LoanDocQA+ API initialized.
2025-10-28 10:26:04 | scripts.LLMquery.api_server | INFO | CHROMA_PATH=scripts/LLMquery/vectorstores/loan_doc_index, LLM_MODEL=phi3, EMBED_MODEL=sentence-transformers/all-MiniLM-L6-v2
2025-10-28 10:26:04 | scripts.LLMquery.api_server | INFO | üìÇ Loading vectorstore and embeddings...
2025-10-28 10:26:05 | scripts.LLMquery.api_server | INFO | ‚úÖ Vectorstore ready with 0 entries.
2025-10-28 10:26:05 | scripts.LLMquery.api_server | INFO | üß† Loading LLM model: phi3
2025-10-28 10:26:05 | scripts.LLMquery.api_server | INFO | ‚úÖ LLM initialized successfully.
2025-10-28 10:26:26 | scripts.LLMquery.api_server | INFO | üìÑ Upload received: errors-failure (1).pdf
2025-10-28 10:26:26 | scripts.LLMquery.api_server | INFO | ‚úÖ File saved to: data/loan_docs/errors-failure (1).pdf
2025-10-28 10:26:36 | scripts.LLMquery.api_server | INFO | üîç Extracting text from uploaded file...
2025-10-28 10:26:36 | scripts.LLMquery.api_server | INFO | üß† Adding new file to Chroma vector index...
2025-10-28 10:26:38 | scripts.LLMquery.api_server | INFO | ‚úÖ Indexed 1 new document(s).
2025-10-28 10:29:40 | scripts.LLMquery.api_server | INFO | üìÑ Upload received: 1. Introduction.pdf
2025-10-28 10:29:40 | scripts.LLMquery.api_server | INFO | ‚úÖ File saved to: data/loan_docs/1. Introduction.pdf
2025-10-28 10:29:40 | scripts.LLMquery.api_server | INFO | üîç Extracting text from uploaded file...
2025-10-28 10:29:40 | scripts.LLMquery.api_server | INFO | üß† Adding new file to Chroma vector index...
2025-10-28 10:29:42 | scripts.LLMquery.api_server | INFO | ‚úÖ Indexed 1 new document(s).
2025-10-28 10:30:07 | scripts.LLMquery.api_server | INFO | üß† New query: 'summarize the contents of Introduction document' | Mode: auto
2025-10-28 10:30:07 | scripts.LLMquery.api_server | DEBUG | üîç Cached retrieval called for: 'summarize the contents of Introduction document...'
2025-10-28 10:30:07 | scripts.LLMquery.api_server | INFO | üìÑ Retrieved 0 document(s) for context.
2025-10-28 10:30:07 | scripts.LLMquery.api_server | INFO | üß≠ Intent=summary | Confidence=0.513 | Gap=0.359
2025-10-28 10:30:07 | scripts.LLMquery.api_server | ERROR | ‚ùå Streaming or response generation failed: All connection attempts failed
Traceback (most recent call last):
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_backends/anyio.py", line 122, in connect_tcp
    stream._raw_socket.setsockopt(*option)  # type: ignore[attr-defined] # pragma: no cover
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/kousiknandury/PycharmProjects/DL_project/scripts/LLMquery/api_server.py", line 187, in token_stream
    await gen_task
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/langchain_core/language_models/llms.py", line 1263, in agenerate
    return await self._agenerate_helper(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/langchain_core/language_models/llms.py", line 1074, in _agenerate_helper
    await self._agenerate(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/langchain_ollama/llms.py", line 478, in _agenerate
    final_chunk = await self._astream_with_aggregation(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/langchain_ollama/llms.py", line 376, in _astream_with_aggregation
    async for stream_resp in self._acreate_generate_stream(prompt, stop, **kwargs):
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/langchain_ollama/llms.py", line 350, in _acreate_generate_stream
    async for part in await self._async_client.generate(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/ollama/_client.py", line 736, in inner
    async with self._client.stream(*args, **kwargs) as r:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 175, in __aenter__
    return await self.gen.__anext__()
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_client.py", line 1583, in stream
    response = await self.send(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/kousiknandury/PycharmProjects/DL_project/.venv/lib/python3.9/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
